#define _CRT_SECURE_NO_WARNINGS
#include <stdio.h>
#define _USE_MATH_DEFINES
#include <math.h>
#include <string.h>
#include <time.h>
#include "Fourier.h"

extern const double sinvals512[];
extern const double sinvals1024[];
extern const double cosvals512[];
extern const double cosvals1024[];
extern const double cosvalsforHigashiWindow512[];
extern const double cosvalsforHigashiWindow1024[];

int FFT(double data[], int aN, double retr[], double reti[]);
int iFFT(double ar[], double ai[], int aN, double retr[]);

DLLEXTRA void logi(std::string logstr) {
	FILE *fp = fopen("log.txt", "a+");
	if(fp == NULL)
		return;

	time_t now = time(NULL);
	struct tm *date = localtime(&now);
	char strtime[256];
	strftime(strtime, sizeof(strtime),"%Y/%m/%d %H:%I:%S", date);

//	fprintf(fp, "%s %s" , strtime, logstr.c_str());
	fprintf(fp, "%s" , logstr.c_str());
	fclose(fp);

	return;
}

/*****************************************************/
/*****************************************************/
DLLEXTRA void print(double *ar, double *ai, int n) {
	int i;
	double *p, *q;

	logi("    ar	ai\n");
	char logstr[FFT_N_1024]={0};
	for(i = 0, p = ar, q = ai; i < n; i++) {
		sprintf(logstr, "%f	%f\n", *p++, *q++);
		logi(logstr);
	}
}

/*****************************************************/
/*****************************************************/
DLLEXTRA void printd(double *ar, int n) {
	int i;
	double *p;

	char logstr[FFT_N_1024]={0};
	for(i = 0, p = ar; i < n; i++) {
		sprintf(logstr, "%f\n", *p++);
		logi(logstr);
	}
}

/****************************************/
/* 東窓関数                             */
/* 引数 : io double indata[] 実データ   */
/* 戻り値 : エラーコード                */
/****************************************/
DLLEXTRA int HigashiWindow(double ConvergenceValue, double ar[], int aN) {
	double *WindowArray = const_cast<double *>(cosvalsforHigashiWindow1024);
	if(aN == FFT_N_512)
		WindowArray = const_cast<double *>(cosvalsforHigashiWindow512);

	for(int lpct = (aN / 2); lpct < aN; lpct++) {
		double temp = WindowArray[lpct];
		ar[lpct] = ar[lpct] * temp + (ConvergenceValue * (1. - temp));
	}
	return FFT_ERROR_NONE;
}

/****************************************************/
/* Filter設定関数                                   */
/* 引数 : i double smooth 滑らか度(0-13ぐらいまで)  */
/*          aN=512 時は、smoothは、9 まで           */
/*          aN=1024時は、smoothは、10まで           */
/*          aN=2048時は、smoothは、11まで           */
/*          aN=4096時は、smoothは、12まで           */
/*        i int    N        配列のサイズ            */
/*        o double filterary[] フィルターパラメータ */
/* 戻り値 : エラーコード                            */
/****************************************************/
DLLEXTRA int setFilter(double smooth, int aN, double filterary[]) {
	filterary[0] = 1;

	double temp = pow(2.0, smooth);
	int lpmax = aN / 2 / static_cast<int>(temp);
	for(int lpct = 1; lpct <= lpmax; lpct++) {
		filterary[lpct] = 1;
		filterary[aN - lpct] = 1;
	}
	
	if(smooth == 0) {
		filterary[lpmax] = 1;
		return FFT_ERROR_NONE;
	}

	double tmpfilterval = fmod(temp,2) / 2;
	filterary[     lpmax] = tmpfilterval;
	filterary[aN - lpmax] = tmpfilterval;
	
	return FFT_ERROR_NONE;
}

/****************************************************/
/* Filter適用関数                                   */
/* 引数 : io double ar[] 実数部分                   */
/*        io double ai[] 虚数部分                   */
/*        i int    aN    配列のサイズ               */
/*        i double filterary[] フィルターパラメータ */
/* 戻り値 : エラーコード                            */
/****************************************************/
DLLEXTRA int execFilter(double ar[], double ai[], int aN, double filterary[]) {
	/* lpct=0は直流成分なので常に1。なので計算不要。 */
	for(int lpct = 1; lpct < aN; lpct++) {
		if(filterary[lpct] == 0) {
			ar[lpct] = 0;
			ai[lpct] = 0;
		}
		else if(filterary[lpct] == 1) {
		}
		else {
			ar[lpct] *= filterary[lpct];
			ai[lpct] *= filterary[lpct];
		}
	}
	return FFT_ERROR_NONE;
}

DLLEXTRA int FFT512(double indata[], int aN, double retXr[], double retXi[]) {
	return FFT(indata, aN, retXr, retXi);
}

DLLEXTRA int FFT1024(double indata[], int aN, double retXr[], double retXi[]) {
	return FFT(indata, aN, retXr, retXi);
}

DLLEXTRA int iFFT512(double ar[], double ai[], int aN, double retr[]) {
	return iFFT(ar, ai, aN, retr);
}

DLLEXTRA int iFFT1024(double ar[], double ai[], int aN, double retr[]) {
	return iFFT(ar, ai, aN, retr);
}

/*****************************************/
/* 高速フーリエ変換                      */
/* 引数 : i double indata[] 実データ     */
/*        i int    aN       配列のサイズ */
/*        o double retXr[] 実数部分      */
/*        o double retXi[] 虚数部分      */
/* 戻り値 : エラーコード                 */
/*****************************************/
int FFT(double indata[], int aN, double retXr[], double retXi[]) {
	if((aN != FFT_N_1024) && (aN != FFT_N_512))
		return FFT_ERROR_ILLEGALARGUMENT;

	memcpy(retXr, indata, sizeof(double) * aN);
	memset(retXi, 0x00, sizeof(double) * aN);

	double *sinvals = const_cast<double*>(sinvals1024);
	double *cosvals = const_cast<double*>(cosvals1024);
	if(aN == FFT_N_512) {
		sinvals = const_cast<double*>(sinvals512);
		cosvals = const_cast<double*>(cosvals512);
	}

	/* ループ数算出 */
	int tmpi = aN;
	int alog2N = 0;
	while((tmpi /= 2) != 0)
		alog2N++;

	int NhalfDecli = aN;
	int pow2inc = 1;
	for(int lpct = 0; lpct < alog2N; lpct++) {
		NhalfDecli /= 2;
		double startposmgr = 0;
		for(int pow2incCnt = 0; pow2incCnt < pow2inc; pow2incCnt++) {
			int trigidx = 0;
			for(int fftidxi = (int)startposmgr, fftidxj = (int)startposmgr + NhalfDecli; fftidxi < startposmgr + NhalfDecli; fftidxi++, fftidxj++) {
				double sumxr = retXr[fftidxi] - retXr[fftidxj];
				double sumxi = retXi[fftidxi] - retXi[fftidxj];
				retXr[fftidxi] += retXr[fftidxj];
				retXi[fftidxi] += retXi[fftidxj];
				if(trigidx == 0) {
					retXr[fftidxj] = sumxr;
					retXi[fftidxj] = sumxi;
				}
				else {
					retXr[fftidxj] = sumxr * cosvals[trigidx] + sumxi * sinvals[trigidx];
					retXi[fftidxj] = sumxi * cosvals[trigidx] - sumxr * sinvals[trigidx];
				}
				//char logstr[FFT_N_1024]={0};
				//sprintf(logstr, "trigidx=%d sumxr=%f sumxi=%f retXr[i(%d)]=%f retXi[i(%d)]=%f retXr[j(%d)]=%f retXi[j(%d)]=%f\n", trigidx, sumxr, sumxi, fftidxi,retXr[fftidxi], fftidxi, retXi[fftidxi], fftidxj,retXr[fftidxj], fftidxj, retXi[fftidxj]);
				//logi(logstr);
				trigidx += pow2inc;
			}
			startposmgr += (2 * NhalfDecli);
		}
		pow2inc *= 2;
	}

	int idxj = aN / 2;
	for(int Nidx = 1; Nidx <= (aN-1); Nidx++) {
		double idxmgr = aN;
		if(idxj < Nidx) {
			double temp1 = retXr[Nidx];
			retXr[Nidx] = retXr[idxj];
			retXr[idxj] = temp1;
			double temp2 = retXi[Nidx];
			retXi[Nidx] = retXi[idxj];
			retXi[idxj] = temp2;
		}
		idxmgr /= 2;
		while(idxj >= idxmgr) {
			idxj -= (int)idxmgr;
			idxmgr /= 2;
		}
		idxj += (int)idxmgr;
	}

	return FFT_ERROR_NONE;
}

/***********************************/
/* 高速フーリエ逆変換              */
/* 引数 : i double ar[] 実数部分   */
/*        i double ai[] 虚数部分   */
/*        i int    N[]  配列サイズ */
/*        o double retr[] 実数部分 */
/*        o double reti[] 虚数部分 */
/* 戻り値 : エラーコード           */
/***********************************/
int iFFT(double ar[], double ai[], int aN, double retr[]) {
	if((aN != FFT_N_1024) && (aN != FFT_N_512))
		return FFT_ERROR_ILLEGALARGUMENT;

	double *sinvals = const_cast<double*>(sinvals1024);
	double *cosvals = const_cast<double*>(cosvals1024);
	if(aN == FFT_N_512) {
		sinvals = const_cast<double*>(sinvals512);
		cosvals = const_cast<double*>(cosvals512);
	}

	double tmpxr[FFT_N_1024] = {0};
	double tmpxi[FFT_N_1024] = {0};
	memcpy(tmpxr, ar, sizeof(double) * aN);
	memcpy(tmpxi, ai, sizeof(double) * aN);

	/* ループ数算出 */
	int tmpi = aN;
	int alog2N = 0;
	while((tmpi /= 2) != 0)
		alog2N++;

	int NhalfDecli = aN;
	int pow2inc = 1;
	for(int lpct = 0; lpct < alog2N; lpct++) {
		NhalfDecli /= 2;
		double startposmgr = 0;
		for(int pow2incCnt = 0; pow2incCnt < pow2inc; pow2incCnt++) {
			int trigidx = 0;
			for(int fftidxi = (int)startposmgr, fftidxj = (int)startposmgr + NhalfDecli; fftidxi < startposmgr + NhalfDecli; fftidxi++, fftidxj++) {
				double sumxr = tmpxr[fftidxi] - tmpxr[fftidxj];
				double sumxi = tmpxi[fftidxi] - tmpxi[fftidxj];
				tmpxr[fftidxi] += tmpxr[fftidxj];
				tmpxi[fftidxi] += tmpxi[fftidxj];
				if(trigidx == 0) {
					tmpxr[fftidxj] = sumxr;
					tmpxi[fftidxj] = sumxi;
				}
				else {
					tmpxr[fftidxj] = sumxr * cosvals[trigidx] + sumxi * sinvals[trigidx];
					tmpxi[fftidxj] = sumxi * cosvals[trigidx] - sumxr * sinvals[trigidx];
				}
				trigidx += pow2inc;
			}
			startposmgr += (2 * NhalfDecli);
		}
		pow2inc *= 2;
	}

	int idxj = aN / 2;
	for(int Nidx = 1; Nidx <= (aN-1); Nidx++) {
		double idxmgr = aN;
		if(idxj < Nidx) {
			double temp1 = tmpxr[Nidx];
			tmpxr[Nidx] = tmpxr[idxj];
			tmpxr[idxj] = temp1;
			double temp2 = tmpxi[Nidx];
			tmpxi[Nidx] = tmpxi[idxj];
			tmpxi[idxj] = temp2;
		}
		idxmgr /= 2;
		while(idxj >= idxmgr) {
			idxj -= (int)idxmgr;
			idxmgr /= 2;
		}

		idxj += (int)idxmgr;
	}

	retr[0] = tmpxr[0] / aN;
	for(int lpct = 1; lpct < aN; lpct++) {
		retr[aN - lpct] = tmpxr[lpct] / aN;
	}

	return FFT_ERROR_NONE;
}

/***************/
/* sin関数の値 */
/***************/
const double sinvals512[] = {
0          ,0.012271538,0.024541229,0.036807223,0.049067674,0.061320736,0.073564564,0.085797312,
0.09801714 ,0.110222207,0.122410675,0.134580709,0.146730474,0.158858143,0.170961889,0.183039888,
0.195090322,0.207111376,0.21910124 ,0.231058108,0.24298018 ,0.25486566 ,0.266712757,0.278519689,
0.290284677,0.302005949,0.31368174 ,0.325310292,0.336889853,0.34841868 ,0.359895037,0.371317194,
0.382683432,0.39399204 ,0.405241314,0.41642956 ,0.427555093,0.438616239,0.44961133 ,0.460538711,
0.471396737,0.482183772,0.492898192,0.503538384,0.514102744,0.524589683,0.53499762 ,0.545324988,
0.555570233,0.565731811,0.575808191,0.585797857,0.595699304,0.605511041,0.615231591,0.624859488,
0.634393284,0.643831543,0.653172843,0.662415778,0.671558955,0.680600998,0.689540545,0.698376249,
0.707106781,0.715730825,0.724247083,0.732654272,0.740951125,0.749136395,0.757208847,0.765167266,
0.773010453,0.780737229,0.788346428,0.795836905,0.803207531,0.810457198,0.817584813,0.824589303,
0.831469612,0.838224706,0.844853565,0.851355193,0.85772861 ,0.863972856,0.870086991,0.876070094,
0.881921264,0.88763962 ,0.893224301,0.898674466,0.903989293,0.909167983,0.914209756,0.919113852,
0.923879533,0.92850608 ,0.932992799,0.937339012,0.941544065,0.945607325,0.949528181,0.95330604 ,
0.956940336,0.960430519,0.963776066,0.966976471,0.970031253,0.972939952,0.97570213 ,0.978317371,
0.98078528 ,0.983105487,0.985277642,0.987301418,0.98917651 ,0.990902635,0.992479535,0.99390697 ,
0.995184727,0.996312612,0.997290457,0.998118113,0.998795456,0.999322385,0.999698819,0.999924702,
1          ,0.999924702,0.999698819,0.999322385,0.998795456,0.998118113,0.997290457,0.996312612,
0.995184727,0.99390697 ,0.992479535,0.990902635,0.98917651 ,0.987301418,0.985277642,0.983105487,
0.98078528 ,0.978317371,0.97570213 ,0.972939952,0.970031253,0.966976471,0.963776066,0.960430519,
0.956940336,0.95330604 ,0.949528181,0.945607325,0.941544065,0.937339012,0.932992799,0.92850608 ,
0.923879533,0.919113852,0.914209756,0.909167983,0.903989293,0.898674466,0.893224301,0.88763962 ,
0.881921264,0.876070094,0.870086991,0.863972856,0.85772861 ,0.851355193,0.844853565,0.838224706,
0.831469612,0.824589303,0.817584813,0.810457198,0.803207531,0.795836905,0.788346428,0.780737229,
0.773010453,0.765167266,0.757208847,0.749136395,0.740951125,0.732654272,0.724247083,0.715730825,
0.707106781,0.698376249,0.689540545,0.680600998,0.671558955,0.662415778,0.653172843,0.643831543,
0.634393284,0.624859488,0.615231591,0.605511041,0.595699304,0.585797857,0.575808191,0.565731811,
0.555570233,0.545324988,0.53499762 ,0.524589683,0.514102744,0.503538384,0.492898192,0.482183772,
0.471396737,0.460538711,0.44961133 ,0.438616239,0.427555093,0.41642956 ,0.405241314,0.39399204 ,
0.382683432,0.371317194,0.359895037,0.34841868 ,0.336889853,0.325310292,0.31368174 ,0.302005949,
0.290284677,0.278519689,0.266712757,0.25486566 ,0.24298018 ,0.231058108,0.21910124 ,0.207111376,
0.195090322,0.183039888,0.170961889,0.158858143,0.146730474,0.134580709,0.122410675,0.110222207,
0.09801714 ,0.085797312,0.073564564,0.061320736,0.049067674,0.036807223,0.024541229,0.012271538,
1.22515E-16
	};

const double sinvals1024[] = {
0          ,0.006135885,0.012271538,0.01840673 ,0.024541229,0.030674803,0.036807223,0.042938257,
0.049067674,0.055195244,0.061320736,0.06744392 ,0.073564564,0.079682438,0.085797312,0.091908956,
0.09801714 ,0.104121634,0.110222207,0.116318631,0.122410675,0.128498111,0.134580709,0.140658239,
0.146730474,0.152797185,0.158858143,0.16491312 ,0.170961889,0.17700422 ,0.183039888,0.189068664,
0.195090322,0.201104635,0.207111376,0.21311032 ,0.21910124 ,0.225083911,0.231058108,0.237023606,
0.24298018 ,0.248927606,0.25486566 ,0.260794118,0.266712757,0.272621355,0.278519689,0.284407537,
0.290284677,0.296150888,0.302005949,0.30784964 ,0.31368174 ,0.319502031,0.325310292,0.331106306,
0.336889853,0.342660717,0.34841868 ,0.354163525,0.359895037,0.365612998,0.371317194,0.37700741 ,
0.382683432,0.388345047,0.39399204 ,0.3996242  ,0.405241314,0.410843171,0.41642956 ,0.422000271,
0.427555093,0.433093819,0.438616239,0.444122145,0.44961133 ,0.455083587,0.460538711,0.465976496,
0.471396737,0.47679923 ,0.482183772,0.48755016 ,0.492898192,0.498227667,0.503538384,0.508830143,
0.514102744,0.51935599 ,0.524589683,0.529803625,0.53499762 ,0.540171473,0.545324988,0.550457973,
0.555570233,0.560661576,0.565731811,0.570780746,0.575808191,0.580813958,0.585797857,0.590759702,
0.595699304,0.600616479,0.605511041,0.610382806,0.615231591,0.620057212,0.624859488,0.629638239,
0.634393284,0.639124445,0.643831543,0.648514401,0.653172843,0.657806693,0.662415778,0.666999922,
0.671558955,0.676092704,0.680600998,0.685083668,0.689540545,0.693971461,0.698376249,0.702754744,
0.707106781,0.711432196,0.715730825,0.720002508,0.724247083,0.72846439 ,0.732654272,0.736816569,
0.740951125,0.745057785,0.749136395,0.753186799,0.757208847,0.761202385,0.765167266,0.769103338,
0.773010453,0.776888466,0.780737229,0.784556597,0.788346428,0.792106577,0.795836905,0.799537269,
0.803207531,0.806847554,0.810457198,0.81403633 ,0.817584813,0.821102515,0.824589303,0.828045045,
0.831469612,0.834862875,0.838224706,0.841554977,0.844853565,0.848120345,0.851355193,0.854557988,
0.85772861 ,0.860866939,0.863972856,0.867046246,0.870086991,0.873094978,0.876070094,0.879012226,
0.881921264,0.884797098,0.88763962 ,0.890448723,0.893224301,0.89596625 ,0.898674466,0.901348847,
0.903989293,0.906595705,0.909167983,0.911706032,0.914209756,0.91667906 ,0.919113852,0.921514039,
0.923879533,0.926210242,0.92850608 ,0.930766961,0.932992799,0.93518351 ,0.937339012,0.939459224,
0.941544065,0.943593458,0.945607325,0.947585591,0.949528181,0.951435021,0.95330604 ,0.955141168,
0.956940336,0.958703475,0.960430519,0.962121404,0.963776066,0.965394442,0.966976471,0.968522094,
0.970031253,0.971503891,0.972939952,0.974339383,0.97570213 ,0.977028143,0.978317371,0.979569766,
0.98078528 ,0.981963869,0.983105487,0.984210092,0.985277642,0.986308097,0.987301418,0.988257568,
0.98917651 ,0.99005821 ,0.990902635,0.991709754,0.992479535,0.993211949,0.99390697 ,0.994564571,
0.995184727,0.995767414,0.996312612,0.996820299,0.997290457,0.997723067,0.998118113,0.998475581,
0.998795456,0.999077728,0.999322385,0.999529418,0.999698819,0.999830582,0.999924702,0.999981175,
1          ,0.999981175,0.999924702,0.999830582,0.999698819,0.999529418,0.999322385,0.999077728,
0.998795456,0.998475581,0.998118113,0.997723067,0.997290457,0.996820299,0.996312612,0.995767414,
0.995184727,0.994564571,0.99390697 ,0.993211949,0.992479535,0.991709754,0.990902635,0.99005821 ,
0.98917651 ,0.988257568,0.987301418,0.986308097,0.985277642,0.984210092,0.983105487,0.981963869,
0.98078528 ,0.979569766,0.978317371,0.977028143,0.97570213 ,0.974339383,0.972939952,0.971503891,
0.970031253,0.968522094,0.966976471,0.965394442,0.963776066,0.962121404,0.960430519,0.958703475,
0.956940336,0.955141168,0.95330604 ,0.951435021,0.949528181,0.947585591,0.945607325,0.943593458,
0.941544065,0.939459224,0.937339012,0.93518351 ,0.932992799,0.930766961,0.92850608 ,0.926210242,
0.923879533,0.921514039,0.919113852,0.91667906 ,0.914209756,0.911706032,0.909167983,0.906595705,
0.903989293,0.901348847,0.898674466,0.89596625 ,0.893224301,0.890448723,0.88763962 ,0.884797098,
0.881921264,0.879012226,0.876070094,0.873094978,0.870086991,0.867046246,0.863972856,0.860866939,
0.85772861 ,0.854557988,0.851355193,0.848120345,0.844853565,0.841554977,0.838224706,0.834862875,
0.831469612,0.828045045,0.824589303,0.821102515,0.817584813,0.81403633 ,0.810457198,0.806847554,
0.803207531,0.799537269,0.795836905,0.792106577,0.788346428,0.784556597,0.780737229,0.776888466,
0.773010453,0.769103338,0.765167266,0.761202385,0.757208847,0.753186799,0.749136395,0.745057785,
0.740951125,0.736816569,0.732654272,0.72846439 ,0.724247083,0.720002508,0.715730825,0.711432196,
0.707106781,0.702754744,0.698376249,0.693971461,0.689540545,0.685083668,0.680600998,0.676092704,
0.671558955,0.666999922,0.662415778,0.657806693,0.653172843,0.648514401,0.643831543,0.639124445,
0.634393284,0.629638239,0.624859488,0.620057212,0.615231591,0.610382806,0.605511041,0.600616479,
0.595699304,0.590759702,0.585797857,0.580813958,0.575808191,0.570780746,0.565731811,0.560661576,
0.555570233,0.550457973,0.545324988,0.540171473,0.53499762 ,0.529803625,0.524589683,0.51935599 ,
0.514102744,0.508830143,0.503538384,0.498227667,0.492898192,0.48755016 ,0.482183772,0.47679923 ,
0.471396737,0.465976496,0.460538711,0.455083587,0.44961133 ,0.444122145,0.438616239,0.433093819,
0.427555093,0.422000271,0.41642956 ,0.410843171,0.405241314,0.3996242  ,0.39399204 ,0.388345047,
0.382683432,0.37700741 ,0.371317194,0.365612998,0.359895037,0.354163525,0.34841868 ,0.342660717,
0.336889853,0.331106306,0.325310292,0.319502031,0.31368174 ,0.30784964 ,0.302005949,0.296150888,
0.290284677,0.284407537,0.278519689,0.272621355,0.266712757,0.260794118,0.25486566 ,0.248927606,
0.24298018 ,0.237023606,0.231058108,0.225083911,0.21910124 ,0.21311032 ,0.207111376,0.201104635,
0.195090322,0.189068664,0.183039888,0.17700422 ,0.170961889,0.16491312 ,0.158858143,0.152797185,
0.146730474,0.140658239,0.134580709,0.128498111,0.122410675,0.116318631,0.110222207,0.104121634,
0.09801714 ,0.091908956,0.085797312,0.079682438,0.073564564,0.06744392 ,0.061320736,0.055195244,
0.049067674,0.042938257,0.036807223,0.030674803,0.024541229,0.01840673 ,0.012271538,0.006135885,
-1.74405E-13,
	};

/***************/
/* cos関数の値 */
/***************/
const double cosvals512[] = {
 1          , 0.999924702, 0.999698819, 0.999322385, 0.998795456, 0.998118113, 0.997290457, 0.996312612,
 0.995184727, 0.99390697 , 0.992479535, 0.990902635, 0.98917651 , 0.987301418, 0.985277642, 0.983105487,
 0.98078528 , 0.978317371, 0.97570213 , 0.972939952, 0.970031253, 0.966976471, 0.963776066, 0.960430519,
 0.956940336, 0.95330604 , 0.949528181, 0.945607325, 0.941544065, 0.937339012, 0.932992799, 0.92850608 ,
 0.923879533, 0.919113852, 0.914209756, 0.909167983, 0.903989293, 0.898674466, 0.893224301, 0.88763962 ,
 0.881921264, 0.876070094, 0.870086991, 0.863972856, 0.85772861 , 0.851355193, 0.844853565, 0.838224706,
 0.831469612, 0.824589303, 0.817584813, 0.810457198, 0.803207531, 0.795836905, 0.788346428, 0.780737229,
 0.773010453, 0.765167266, 0.757208847, 0.749136395, 0.740951125, 0.732654272, 0.724247083, 0.715730825,
 0.707106781, 0.698376249, 0.689540545, 0.680600998, 0.671558955, 0.662415778, 0.653172843, 0.643831543,
 0.634393284, 0.624859488, 0.615231591, 0.605511041, 0.595699304, 0.585797857, 0.575808191, 0.565731811,
 0.555570233, 0.545324988, 0.53499762 , 0.524589683, 0.514102744, 0.503538384, 0.492898192, 0.482183772,
 0.471396737, 0.460538711, 0.44961133 , 0.438616239, 0.427555093, 0.41642956 , 0.405241314, 0.39399204 ,
 0.382683432, 0.371317194, 0.359895037, 0.34841868 , 0.336889853, 0.325310292, 0.31368174 , 0.302005949,
 0.290284677, 0.278519689, 0.266712757, 0.25486566 , 0.24298018 , 0.231058108, 0.21910124 , 0.207111376,
 0.195090322, 0.183039888, 0.170961889, 0.158858143, 0.146730474, 0.134580709, 0.122410675, 0.110222207,
 0.09801714 , 0.085797312, 0.073564564, 0.061320736, 0.049067674, 0.036807223, 0.024541229, 0.012271538,
 6.12574E-17,-0.012271538,-0.024541229,-0.036807223,-0.049067674,-0.061320736,-0.073564564,-0.085797312,
-0.09801714 ,-0.110222207,-0.122410675,-0.134580709,-0.146730474,-0.158858143,-0.170961889,-0.183039888,
-0.195090322,-0.207111376,-0.21910124 ,-0.231058108,-0.24298018 ,-0.25486566 ,-0.266712757,-0.278519689,
-0.290284677,-0.302005949,-0.31368174 ,-0.325310292,-0.336889853,-0.34841868 ,-0.359895037,-0.371317194,
-0.382683432,-0.39399204 ,-0.405241314,-0.41642956 ,-0.427555093,-0.438616239,-0.44961133 ,-0.460538711,
-0.471396737,-0.482183772,-0.492898192,-0.503538384,-0.514102744,-0.524589683,-0.53499762 ,-0.545324988,
-0.555570233,-0.565731811,-0.575808191,-0.585797857,-0.595699304,-0.605511041,-0.615231591,-0.624859488,
-0.634393284,-0.643831543,-0.653172843,-0.662415778,-0.671558955,-0.680600998,-0.689540545,-0.698376249,
-0.707106781,-0.715730825,-0.724247083,-0.732654272,-0.740951125,-0.749136395,-0.757208847,-0.765167266,
-0.773010453,-0.780737229,-0.788346428,-0.795836905,-0.803207531,-0.810457198,-0.817584813,-0.824589303,
-0.831469612,-0.838224706,-0.844853565,-0.851355193,-0.85772861 ,-0.863972856,-0.870086991,-0.876070094,
-0.881921264,-0.88763962 ,-0.893224301,-0.898674466,-0.903989293,-0.909167983,-0.914209756,-0.919113852,
-0.923879533,-0.92850608 ,-0.932992799,-0.937339012,-0.941544065,-0.945607325,-0.949528181,-0.95330604 ,
-0.956940336,-0.960430519,-0.963776066,-0.966976471,-0.970031253,-0.972939952,-0.97570213 ,-0.978317371,
-0.98078528 ,-0.983105487,-0.985277642,-0.987301418,-0.98917651 ,-0.990902635,-0.992479535,-0.99390697 ,
-0.995184727,-0.996312612,-0.997290457,-0.998118113,-0.998795456,-0.999322385,-0.999698819,-0.999924702,
-1,
	};

const double cosvals1024[] = {
1           ,0.999981175 ,0.999924702 ,0.999830582 ,0.999698819 ,0.999529418 ,0.999322385 ,0.999077728 ,
0.998795456 ,0.998475581 ,0.998118113 ,0.997723067 ,0.997290457 ,0.996820299 ,0.996312612 ,0.995767414 ,
0.995184727 ,0.994564571 ,0.99390697  ,0.993211949 ,0.992479535 ,0.991709754 ,0.990902635 ,0.99005821  ,
0.98917651  ,0.988257568 ,0.987301418 ,0.986308097 ,0.985277642 ,0.984210092 ,0.983105487 ,0.981963869 ,
0.98078528  ,0.979569766 ,0.978317371 ,0.977028143 ,0.97570213  ,0.974339383 ,0.972939952 ,0.971503891 ,
0.970031253 ,0.968522094 ,0.966976471 ,0.965394442 ,0.963776066 ,0.962121404 ,0.960430519 ,0.958703475 ,
0.956940336 ,0.955141168 ,0.95330604  ,0.951435021 ,0.949528181 ,0.947585591 ,0.945607325 ,0.943593458 ,
0.941544065 ,0.939459224 ,0.937339012 ,0.93518351  ,0.932992799 ,0.930766961 ,0.92850608  ,0.926210242 ,
0.923879533 ,0.921514039 ,0.919113852 ,0.91667906  ,0.914209756 ,0.911706032 ,0.909167983 ,0.906595705 ,
0.903989293 ,0.901348847 ,0.898674466 ,0.89596625  ,0.893224301 ,0.890448723 ,0.88763962  ,0.884797098 ,
0.881921264 ,0.879012226 ,0.876070094 ,0.873094978 ,0.870086991 ,0.867046246 ,0.863972856 ,0.860866939 ,
0.85772861  ,0.854557988 ,0.851355193 ,0.848120345 ,0.844853565 ,0.841554977 ,0.838224706 ,0.834862875 ,
0.831469612 ,0.828045045 ,0.824589303 ,0.821102515 ,0.817584813 ,0.81403633  ,0.810457198 ,0.806847554 ,
0.803207531 ,0.799537269 ,0.795836905 ,0.792106577 ,0.788346428 ,0.784556597 ,0.780737229 ,0.776888466 ,
0.773010453 ,0.769103338 ,0.765167266 ,0.761202385 ,0.757208847 ,0.753186799 ,0.749136395 ,0.745057785 ,
0.740951125 ,0.736816569 ,0.732654272 ,0.72846439  ,0.724247083 ,0.720002508 ,0.715730825 ,0.711432196 ,
0.707106781 ,0.702754744 ,0.698376249 ,0.693971461 ,0.689540545 ,0.685083668 ,0.680600998 ,0.676092704 ,
0.671558955 ,0.666999922 ,0.662415778 ,0.657806693 ,0.653172843 ,0.648514401 ,0.643831543 ,0.639124445 ,
0.634393284 ,0.629638239 ,0.624859488 ,0.620057212 ,0.615231591 ,0.610382806 ,0.605511041 ,0.600616479 ,
0.595699304 ,0.590759702 ,0.585797857 ,0.580813958 ,0.575808191 ,0.570780746 ,0.565731811 ,0.560661576 ,
0.555570233 ,0.550457973 ,0.545324988 ,0.540171473 ,0.53499762  ,0.529803625 ,0.524589683 ,0.51935599  ,
0.514102744 ,0.508830143 ,0.503538384 ,0.498227667 ,0.492898192 ,0.48755016  ,0.482183772 ,0.47679923  ,
0.471396737 ,0.465976496 ,0.460538711 ,0.455083587 ,0.44961133  ,0.444122145 ,0.438616239 ,0.433093819 ,
0.427555093 ,0.422000271 ,0.41642956  ,0.410843171 ,0.405241314 ,0.3996242   ,0.39399204  ,0.388345047 ,
0.382683432 ,0.37700741  ,0.371317194 ,0.365612998 ,0.359895037 ,0.354163525 ,0.34841868  ,0.342660717 ,
0.336889853 ,0.331106306 ,0.325310292 ,0.319502031 ,0.31368174  ,0.30784964  ,0.302005949 ,0.296150888 ,
0.290284677 ,0.284407537 ,0.278519689 ,0.272621355 ,0.266712757 ,0.260794118 ,0.25486566  ,0.248927606 ,
0.24298018  ,0.237023606 ,0.231058108 ,0.225083911 ,0.21910124  ,0.21311032  ,0.207111376 ,0.201104635 ,
0.195090322 ,0.189068664 ,0.183039888 ,0.17700422  ,0.170961889 ,0.16491312  ,0.158858143 ,0.152797185 ,
0.146730474 ,0.140658239 ,0.134580709 ,0.128498111 ,0.122410675 ,0.116318631 ,0.110222207 ,0.104121634 ,
0.09801714  ,0.091908956 ,0.085797312 ,0.079682438 ,0.073564564 ,0.06744392  ,0.061320736 ,0.055195244 ,
0.049067674 ,0.042938257 ,0.036807223 ,0.030674803 ,0.024541229 ,0.01840673  ,0.012271538 ,0.006135885 ,
-1.07408E-13,-0.006135885,-0.012271538,-0.01840673 ,-0.024541229,-0.030674803,-0.036807223,-0.042938257,
-0.049067674,-0.055195244,-0.061320736,-0.06744392 ,-0.073564564,-0.079682438,-0.085797312,-0.091908956,
-0.09801714 ,-0.104121634,-0.110222207,-0.116318631,-0.122410675,-0.128498111,-0.134580709,-0.140658239,
-0.146730474,-0.152797185,-0.158858143,-0.16491312 ,-0.170961889,-0.17700422 ,-0.183039888,-0.189068664,
-0.195090322,-0.201104635,-0.207111376,-0.21311032 ,-0.21910124 ,-0.225083911,-0.231058108,-0.237023606,
-0.24298018 ,-0.248927606,-0.25486566 ,-0.260794118,-0.266712757,-0.272621355,-0.278519689,-0.284407537,
-0.290284677,-0.296150888,-0.302005949,-0.30784964 ,-0.31368174 ,-0.319502031,-0.325310292,-0.331106306,
-0.336889853,-0.342660717,-0.34841868 ,-0.354163525,-0.359895037,-0.365612998,-0.371317194,-0.37700741 ,
-0.382683432,-0.388345047,-0.39399204 ,-0.3996242  ,-0.405241314,-0.410843171,-0.41642956 ,-0.422000271,
-0.427555093,-0.433093819,-0.438616239,-0.444122145,-0.44961133 ,-0.455083587,-0.460538711,-0.465976496,
-0.471396737,-0.47679923 ,-0.482183772,-0.48755016 ,-0.492898192,-0.498227667,-0.503538384,-0.508830143,
-0.514102744,-0.51935599 ,-0.524589683,-0.529803625,-0.53499762 ,-0.540171473,-0.545324988,-0.550457973,
-0.555570233,-0.560661576,-0.565731811,-0.570780746,-0.575808191,-0.580813958,-0.585797857,-0.590759702,
-0.595699304,-0.600616479,-0.605511041,-0.610382806,-0.615231591,-0.620057212,-0.624859488,-0.629638239,
-0.634393284,-0.639124445,-0.643831543,-0.648514401,-0.653172843,-0.657806693,-0.662415778,-0.666999922,
-0.671558955,-0.676092704,-0.680600998,-0.685083668,-0.689540545,-0.693971461,-0.698376249,-0.702754744,
-0.707106781,-0.711432196,-0.715730825,-0.720002508,-0.724247083,-0.72846439 ,-0.732654272,-0.736816569,
-0.740951125,-0.745057785,-0.749136395,-0.753186799,-0.757208847,-0.761202385,-0.765167266,-0.769103338,
-0.773010453,-0.776888466,-0.780737229,-0.784556597,-0.788346428,-0.792106577,-0.795836905,-0.799537269,
-0.803207531,-0.806847554,-0.810457198,-0.81403633 ,-0.817584813,-0.821102515,-0.824589303,-0.828045045,
-0.831469612,-0.834862875,-0.838224706,-0.841554977,-0.844853565,-0.848120345,-0.851355193,-0.854557988,
-0.85772861 ,-0.860866939,-0.863972856,-0.867046246,-0.870086991,-0.873094978,-0.876070094,-0.879012226,
-0.881921264,-0.884797098,-0.88763962 ,-0.890448723,-0.893224301,-0.89596625 ,-0.898674466,-0.901348847,
-0.903989293,-0.906595705,-0.909167983,-0.911706032,-0.914209756,-0.91667906 ,-0.919113852,-0.921514039,
-0.923879533,-0.926210242,-0.92850608 ,-0.930766961,-0.932992799,-0.93518351 ,-0.937339012,-0.939459224,
-0.941544065,-0.943593458,-0.945607325,-0.947585591,-0.949528181,-0.951435021,-0.95330604 ,-0.955141168,
-0.956940336,-0.958703475,-0.960430519,-0.962121404,-0.963776066,-0.965394442,-0.966976471,-0.968522094,
-0.970031253,-0.971503891,-0.972939952,-0.974339383,-0.97570213 ,-0.977028143,-0.978317371,-0.979569766,
-0.98078528 ,-0.981963869,-0.983105487,-0.984210092,-0.985277642,-0.986308097,-0.987301418,-0.988257568,
-0.98917651 ,-0.99005821 ,-0.990902635,-0.991709754,-0.992479535,-0.993211949,-0.99390697 ,-0.994564571,
-0.995184727,-0.995767414,-0.996312612,-0.996820299,-0.997290457,-0.997723067,-0.998118113,-0.998475581,
-0.998795456,-0.999077728,-0.999322385,-0.999529418,-0.999698819,-0.999830582,-0.999924702,-0.999981175,
-1,
	};

/***************/
/* cos関数(16πn/1024)の値 */
/***************/
const double cosvalsforHigashiWindow1024[] = {
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
0.999990588, 0.999962351, 0.999915291, 0.999849409, 0.999764709, 0.999661192, 0.999538864, 0.999397728,
0.99923779 , 0.999059056, 0.998861533, 0.998645228, 0.99841015 , 0.998156306, 0.997883707, 0.997592363,
0.997282285, 0.996953485, 0.996605975, 0.996239767, 0.995854877, 0.995451318, 0.995029105, 0.994588255,
0.994128784, 0.993650709, 0.993154049, 0.992638821, 0.992105046, 0.991552744, 0.990981935, 0.99039264 ,
0.989784883, 0.989158685, 0.988514071, 0.987851065, 0.987169691, 0.986469976, 0.985751945, 0.985015627,
0.984261047, 0.983488236, 0.982697221, 0.981888033, 0.981060702, 0.98021526 , 0.979351737, 0.978470168,
0.977570584, 0.97665302 , 0.97571751 , 0.97476409 , 0.973792796, 0.972803663, 0.971796729, 0.970772033,
0.969729612, 0.968669506, 0.967591755, 0.966496399, 0.965383481, 0.96425304 , 0.963105121, 0.961939766,
0.96075702 , 0.959556926, 0.95833953 , 0.957104878, 0.955853016, 0.954583992, 0.953297852, 0.951994647,
0.950674424, 0.949337233, 0.947983125, 0.946612151, 0.945224362, 0.94381981 , 0.942398549, 0.940960632,
0.939506113, 0.938035047, 0.936547489, 0.935043496, 0.933523123, 0.931986428, 0.930433469, 0.928864305,
0.927278994, 0.925677597, 0.924060172, 0.922426783, 0.920777489, 0.919112353, 0.917431437, 0.915734806,
0.914022523, 0.912294651, 0.910551257, 0.908792407, 0.907018165, 0.905228599, 0.903423777, 0.901603766,
0.899768635, 0.897918452, 0.896053289, 0.894173214, 0.892278299, 0.890368614, 0.888444233, 0.886505227,
0.884551669, 0.882583633, 0.880601193, 0.878604423, 0.8765934  , 0.874568197, 0.872528893, 0.870475563,
0.868408284, 0.866327136, 0.864232195, 0.862123541, 0.860001254, 0.857865413, 0.855716098, 0.853553391,
0.851377372, 0.849188125, 0.84698573 , 0.844770272, 0.842541834, 0.840300499, 0.838046352, 0.835779477,
0.833499961, 0.831207889, 0.828903347, 0.826586421, 0.824257201, 0.821915771, 0.819562222, 0.817196642,
0.814819119, 0.812429744, 0.810028606, 0.807615795, 0.805191403, 0.802755521, 0.80030824 , 0.797849652,
0.795379851, 0.792898929, 0.790406979, 0.787904096, 0.785390373, 0.782865905, 0.780330788, 0.777785117,
0.775228986, 0.772662494, 0.770085736, 0.76749881 , 0.764901812, 0.762294841, 0.759677995, 0.757051372,
0.754415071, 0.751769192, 0.749113833, 0.746449096, 0.74377508 , 0.741091886, 0.738399615, 0.735698368,
0.732988248, 0.730269355, 0.727541794, 0.724805665, 0.722061072, 0.719308119, 0.716546909, 0.713777547,
0.711000135, 0.70821478 , 0.705421586, 0.702620657, 0.6998121  , 0.69699602 , 0.694172523, 0.691341716,
0.688503705, 0.685658597, 0.682806499, 0.679947518, 0.677081763, 0.67420934 , 0.671330359, 0.668444927,
0.665553153, 0.662655146, 0.659751015, 0.65684087 , 0.65392482 , 0.651002975, 0.648075444, 0.645142339,
0.642203769, 0.639259845, 0.636310678, 0.633356379, 0.630397059, 0.62743283 , 0.624463803, 0.62149009 ,
0.618511803, 0.615529054, 0.612541956, 0.60955062 , 0.60655516 , 0.603555688, 0.600552317, 0.597545161,
0.594534332, 0.591519944, 0.58850211 , 0.585480944, 0.58245656 , 0.579429072, 0.576398593, 0.573365237,
0.57032912 , 0.567290354, 0.564249055, 0.561205338, 0.558159315, 0.555111104, 0.552060817, 0.54900857 ,
0.545954478, 0.542898656, 0.539841219, 0.536782282, 0.53372196 , 0.530660368, 0.527597622, 0.524533837,
0.521469128, 0.518403611, 0.515337402, 0.512270614, 0.509203365, 0.506135769, 0.503067942, 0.5        ,
0.496932058, 0.493864231, 0.490796635, 0.487729386, 0.484662598, 0.481596389, 0.478530872, 0.475466163,
0.472402378, 0.469339632, 0.46627804 , 0.463217718, 0.460158781, 0.457101344, 0.454045522, 0.45099143 ,
0.447939183, 0.444888896, 0.441840685, 0.438794662, 0.435750945, 0.432709646, 0.42967088 , 0.426634763,
0.423601407, 0.420570928, 0.41754344 , 0.414519056, 0.41149789 , 0.408480056, 0.405465668, 0.402454839,
0.399447683, 0.396444312, 0.39344484 , 0.39044938 , 0.387458044, 0.384470946, 0.381488197, 0.37850991 ,
0.375536197, 0.37256717 , 0.369602941, 0.366643621, 0.363689322, 0.360740155, 0.357796231, 0.354857661,
0.351924556, 0.348997025, 0.34607518 , 0.34315913 , 0.340248985, 0.337344854, 0.334446847, 0.331555073,
0.328669641, 0.32579066 , 0.322918237, 0.320052482, 0.317193501, 0.314341403, 0.311496295, 0.308658284,
0.305827477, 0.30300398 , 0.3001879  , 0.297379343, 0.294578414, 0.29178522 , 0.288999865, 0.286222453,
0.283453091, 0.280691881, 0.277938928, 0.275194335, 0.272458206, 0.269730645, 0.267011752, 0.264301632,
0.261600385, 0.258908114, 0.25622492 , 0.253550904, 0.250886167, 0.248230808, 0.245584929, 0.242948628,
0.240322005, 0.237705159, 0.235098188, 0.23250119 , 0.229914264, 0.227337506, 0.224771014, 0.222214883,
0.219669212, 0.217134095, 0.214609627, 0.212095904, 0.209593021, 0.207101071, 0.204620149, 0.202150348,
0.19969176 , 0.197244479, 0.194808597, 0.192384205, 0.189971394, 0.187570256, 0.185180881, 0.182803358,
0.180437778, 0.178084229, 0.175742799, 0.173413579, 0.171096653, 0.168792111, 0.166500039, 0.164220523,
0.161953648, 0.159699501, 0.157458166, 0.155229728, 0.15301427 , 0.150811875, 0.148622628, 0.146446609,
0.144283902, 0.142134587, 0.139998746, 0.137876459, 0.135767805, 0.133672864, 0.131591716, 0.129524437,
0.127471107, 0.125431803, 0.1234066  , 0.121395577, 0.119398807, 0.117416367, 0.115448331, 0.113494773,
0.111555767, 0.109631386, 0.107721701, 0.105826786, 0.103946711, 0.102081548, 0.100231365, 0.098396234,
0.096576223, 0.094771401, 0.092981835, 0.091207593, 0.089448743, 0.087705349, 0.085977477, 0.084265194,
0.082568563, 0.080887647, 0.079222511, 0.077573217, 0.075939828, 0.074322403, 0.072721006, 0.071135695,
0.069566531, 0.068013572, 0.066476877, 0.064956504, 0.063452511, 0.061964953, 0.060493887, 0.059039368,
0.057601451, 0.05618019 , 0.054775638, 0.053387849, 0.052016875, 0.050662767, 0.049325576, 0.048005353,
0.046702148, 0.045416008, 0.044146984, 0.042895122, 0.04166047 , 0.040443074, 0.03924298 , 0.038060234,
0.036894879, 0.03574696 , 0.034616519, 0.033503601, 0.032408245, 0.031330494, 0.030270388, 0.029227967,
0.028203271, 0.027196337, 0.026207204, 0.02523591 , 0.02428249 , 0.02334698 , 0.022429416, 0.021529832,
0.020648263, 0.01978474 , 0.018939298, 0.018111967, 0.017302779, 0.016511764, 0.015738953, 0.014984373,
0.014248055, 0.013530024, 0.012830309, 0.012148935, 0.011485929, 0.010841315, 0.010215117, 0.00960736 ,
0.009018065, 0.008447256, 0.007894954, 0.007361179, 0.006845951, 0.006349291, 0.005871216, 0.005411745,
0.004970895, 0.004548682, 0.004145123, 0.003760233, 0.003394025, 0.003046515, 0.002717715, 0.002407637,
0.002116293, 0.001843694, 0.00158985 , 0.001354772, 0.001138467, 0.000940944, 0.00076221 , 0.000602272,
0.000461136, 0.000338808, 0.000235291, 0.000150591, 8.47091E-05, 3.76491E-05, 9.41236E-06, 0          ,
	};

/***********************************/
/* cos(2π(n+256)/512)*0.5+0.5の値 */
/***********************************/
const double cosvalsforHigashiWindow512[] = {
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
1          ,1          ,1          ,1          ,1          ,1          ,1          ,1          ,
0.999962351,0.999849409,0.999661192,0.999397728,0.999059056,0.998645228,0.998156306,0.997592363,
0.996953485,0.996239767,0.995451318,0.994588255,0.993650709,0.992638821,0.991552744,0.99039264 ,
0.989158685,0.987851065,0.986469976,0.985015627,0.983488236,0.981888033,0.98021526 ,0.978470168,
0.97665302 ,0.97476409 ,0.972803663,0.970772033,0.968669506,0.966496399,0.96425304 ,0.961939766,
0.959556926,0.957104878,0.954583992,0.951994647,0.949337233,0.946612151,0.94381981 ,0.940960632,
0.938035047,0.935043496,0.931986428,0.928864305,0.925677597,0.922426783,0.919112353,0.915734806,
0.912294651,0.908792407,0.905228599,0.901603766,0.897918452,0.894173214,0.890368614,0.886505227,
0.882583633,0.878604423,0.874568197,0.870475563,0.866327136,0.862123541,0.857865413,0.853553391,
0.849188125,0.844770272,0.840300499,0.835779477,0.831207889,0.826586421,0.821915771,0.817196642,
0.812429744,0.807615795,0.802755521,0.797849652,0.792898929,0.787904096,0.782865905,0.777785117,
0.772662494,0.76749881 ,0.762294841,0.757051372,0.751769192,0.746449096,0.741091886,0.735698368,
0.730269355,0.724805665,0.719308119,0.713777547,0.70821478 ,0.702620657,0.69699602 ,0.691341716,
0.685658597,0.679947518,0.67420934 ,0.668444927,0.662655146,0.65684087 ,0.651002975,0.645142339,
0.639259845,0.633356379,0.62743283 ,0.62149009 ,0.615529054,0.60955062 ,0.603555688,0.597545161,
0.591519944,0.585480944,0.579429072,0.573365237,0.567290354,0.561205338,0.555111104,0.54900857 ,
0.542898656,0.536782282,0.530660368,0.524533837,0.518403611,0.512270614,0.506135769,0.5        ,
0.493864231,0.487729386,0.481596389,0.475466163,0.469339632,0.463217718,0.457101344,0.45099143 ,
0.444888896,0.438794662,0.432709646,0.426634763,0.420570928,0.414519056,0.408480056,0.402454839,
0.396444312,0.39044938 ,0.384470946,0.37850991 ,0.37256717 ,0.366643621,0.360740155,0.354857661,
0.348997025,0.34315913 ,0.337344854,0.331555073,0.32579066 ,0.320052482,0.314341403,0.308658284,
0.30300398 ,0.297379343,0.29178522 ,0.286222453,0.280691881,0.275194335,0.269730645,0.264301632,
0.258908114,0.253550904,0.248230808,0.242948628,0.237705159,0.23250119 ,0.227337506,0.222214883,
0.217134095,0.212095904,0.207101071,0.202150348,0.197244479,0.192384205,0.187570256,0.182803358,
0.178084229,0.173413579,0.168792111,0.164220523,0.159699501,0.155229728,0.150811875,0.146446609,
0.142134587,0.137876459,0.133672864,0.129524437,0.125431803,0.121395577,0.117416367,0.113494773,
0.109631386,0.105826786,0.102081548,0.098396234,0.094771401,0.091207593,0.087705349,0.084265194,
0.080887647,0.077573217,0.074322403,0.071135695,0.068013572,0.064956504,0.061964953,0.059039368,
0.05618019 ,0.053387849,0.050662767,0.048005353,0.045416008,0.042895122,0.040443074,0.038060234,
0.03574696 ,0.033503601,0.031330494,0.029227967,0.027196337,0.02523591 ,0.02334698 ,0.021529832,
0.01978474 ,0.018111967,0.016511764,0.014984373,0.013530024,0.012148935,0.010841315,0.00960736 ,
0.008447256,0.007361179,0.006349291,0.005411745,0.004548682,0.003760233,0.003046515,0.002407637,
0.001843694,0.001354772,0.000940944,0.000602272,0.000338808,0.000150591,3.76491E-05,0          ,
	};
